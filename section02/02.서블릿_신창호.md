# ìŠ¤í”„ë§ì˜ ê°•ì˜ ë¦¬ë·°ğŸ“½

> LoadMap Part : ìŠ¤í”„ë§ MVC íŒ¨í„´ 1í¸  
> Section :  02. ì„œë¸”ë¦¿  
> CreateDate : 2022.07.11  
> UpdateDate :    

### ëª©ì°¨

- [í”„ë¡œì íŠ¸ìƒì„±](#Project) 

- Hello ì„œë¸”ë¦¿

- HttpServletRequest 
  
  - ê°œìš”
  
  - ê¸°ë³¸ ì‚¬ìš©ë²•

- HTTP ìš”ì²­ë°ì´í„° 

<br></br>

# 1. í”„ë¡œì íŠ¸ ìƒì„±<a name = "Project"></a>

<img title="" src="https://user-images.githubusercontent.com/104331549/178292154-e3f53b03-e6b5-488c-9b1b-a5bb47a4df80.png" alt="" width="470" data-align="center">

> PackagingëŠ” Jarê°€ ì•„ë‹ˆë¼ Warë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”. JSPë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•©ë‹ˆë‹¤.

- [ìŠ¤í”„ë§ë¶€íŠ¸ ì„¤ì¹˜](start.spring.io)

- ì„¤ì¹˜í•´ë³´ê³ ,  ë©”ì¸ í´ë˜ìŠ¤ ì‹¤í–‰ í•´ë³´ê¸° [localhost:8080](http://localhost:8080/)

### ê¸°ë³¸ ì„¸íŒ…

- ìœ ë£Œë²„ì „ì¸ ê²½ìš° build íˆ´ ë³€ê²½  `Gradle` -> `IntelliJ`
  
  - ë¬´ë£Œë²„ì „ì€ `Gradle` ê·¸ëŒ€ë¡œ
  
  - [ì¦ë¶„ ë¹Œë“œì— ëŒ€í•˜ì—¬]([TIL/í•œê¸€ì…ë ¥ ì˜¤ë¥˜.md at f3ed866a091e176de4a59f322c8c4ab3c4cdfadf Â· Gloom-shin/TIL Â· GitHub](https://github.com/Gloom-shin/TIL/blob/f3ed866a091e176de4a59f322c8c4ab3c4cdfadf/%EC%98%A4%EB%A5%98%EC%99%80%20%ED%95%B4%EA%B2%B0%EC%B1%85/IntelliJ/%ED%95%9C%EA%B8%80%EC%9E%85%EB%A0%A5%20%EC%98%A4%EB%A5%98.md))

- lombok ì„¸íŒ… 
  
  - `Preferences` ->`plugin` -> `lombok` ê²€ìƒ‰ ì‹¤í–‰ -> (ì¬ì‹œì‘)
  
  - `Preferences` -> `Annotation Processors` ê²€ìƒ‰ -> `Enable annotation processing` ì²´í¬ -> (ì¬ì‹œì‘)

- [PostMan ì„¤ì¹˜]([Download Postman | Get Started for Free](https://www.postman.com/downloads/))

<br></br>
<br></br>

# Hello ì„œë¸”ë¦¿

> ì„œë¸”ë¦¿ ë“±ë¡í•˜ê³  ì‚¬ìš©í•´ë³´ê¸°

#### ì›ë˜ ì„œë¸”ë¦¿ ì„¤ì¹˜ ê³¼ì •

- ì„œë¸”ë¦¿ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ë¥¼ ì§ì ‘ ì„¤ì¹˜í•˜ê³ , 

- ê·¸ ìœ„ì— ì„œë¸”ë¦¿ ì½”ë“œë¥¼ í´ë˜ìŠ¤ íŒŒì¼(.class)ë¡œ ë¹Œë“œí•´ì„œ ì˜¬ë¦° ë‹¤ìŒ,

- ì„œë²„ë¥¼ ì‹¤í–‰í•´ì•¼ ëœë‹¤.

> ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” í†°ìº£ì„ ë‚´ì¥í•˜ì—¬ í¸ë¦¬í•˜ê²Œ ì„œë¸”ë¦¿ ì½”ë“œ ì‚¬ìš© ê°€ëŠ¥

<br></br>

## ìŠ¤í”„ë§ ë¶€íŠ¸ ì„œë¸”ë¦¿ í™˜ê²½ êµ¬ì„±

- `@ServletComponentScan`  : ì„œë¸”ë¦¿ì„ ì§ì ‘ ë“±ë¡í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìŠ¤ìº”í•˜ì—¬, ìë™ ë“±ë¡í•´ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜

### ì„œë¸”ë¦¿ ë“±ë¡í•˜ê¸°

- `@WebServlet` ì„œë¸”ë¦¿ ì• ë…¸í…Œì´ì…˜
  
  - `name` : ì„œë¸”ë¦¿ ì´ë¦„
  
  - `urlPatterns` : URL ë§¤í•‘

```java
@WebServlet(name ="helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        System.out.println("HelloServlet.service");
        System.out.println("req = " + req);
        System.out.println("resp = " + resp);  

Â Â Â Â Â Â Â Â String username = req.getParameter("username");
        System.out.println("username = " + username);
    }
}
```

### ìš”ì²­ê³¼ ë‹µë³€

<img title="" src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-00-34-58-image.png" alt="" data-align="center" width="453">

<img title="" src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-00-34-15-image.png" alt="" data-align="center" width="438">

<br></br>

### HTTP ìš”ì²­ ë©”ì‹œì§€ ë¡œê·¸ë¡œ í™•ì¸í•˜ê¸°

> `application.properties` íŒŒì¼ì—   
> 
> `logging.level.org.apache.coyote.http11=debug` ì„ ì…ë ¥í•´ì£¼ë©´  
>
> ì„œë²„ê°€ ë°›ì€ HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•œë‹¤.

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-00-40-07-image.png)

### ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ ë™ì‘ ë°©ì‹ ì„¤ëª…

- ë‚´ì¥ í†°ìº£ ì„œë²„ ìƒì„±

<img src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-00-42-06-image.png" title="" alt="" data-align="center">

- HTTP ìš”ì²­ ë° ì‘ë‹µ ë©”ì‹œì§€ ìƒì„±
  
  ![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-00-43-42-image.png)

- ì‘ë‹µ

<img src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-00-44-27-image.png" title="" alt="" data-align="center">

## í˜ì´ì§€ ì¶”ê°€

> `main/webapp` ê²½ë¡œì— `index.html` ì„ ë‘ë©´ http://localhost:8080 í˜¸ì¶œì‹œ   
> 
> `index.html` í˜ì´ì§€ê°€ ì—´ë¦°ë‹¤


<br></br>
<br></br>

# HttpServletRequest

## ê°œìš”

>  ì„œë¸”ë¦¿ì€ ê°œë°œìê°€ HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê°œë°œì ëŒ€ì‹ í•´ì„œ, HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ íŒŒì‹±í•œë‹¤. ê·¸ë¦¬ê³  ê·¸ ê²°ê³¼ë¥¼ `HttpServletRequest`ê°ì²´ì— ë‹´ì•„ì„œ ì œê³µí•œë‹¤. 

- HttpServletRequestì—ì„œ HTTP ìš”ì²­ë©”ì‹œì§€ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ í•  ìˆ˜ ìˆë‹¤.
  
  #### ì£¼ìš” ê¸°ëŠ¥
  
  - HTTP ë©”ì†Œë“œ 
  
  - URL
  
  - ì¿¼ë¦¬ ìŠ¤íŠ¸ë§
  
  - ìŠ¤í‚¤ë§ˆ, í”„ë¡œí† ì½œ
  
  - í—¤ë”ì¡°íšŒ
  
  - form íŒŒë¼ë¯¸í„° í˜•ì‹ ì¡°íšŒ
  
  - Message Body ë°ì´í„° ì§ì ‘ì¡°íšŒ

#### ë¶€ê°€ ê¸°ëŠ¥

- HTTP ìš”ì²­ì´ (ì‹œì‘~ë)ì‚¬ì´ ìœ ì§€ë˜ëŠ” ì„ì‹œì €ì¥ì†Œ ê¸°ëŠ¥
  
  - ì €ì¥ :  `request.setAttribute(name, value)`
  
  - ì¡°íšŒ :  `request.setAttribute(name)`

- ì„¸ì…˜ê´€ë¦¬ ê¸°ëŠ¥
  
  - `request.getSession(create: true)`

<br></br>

<br></br>

## ê¸°ë³¸ ì‚¬ìš©ë²•

> ì‚¬ìš©ëœ ë‹¨ì¶•í‚¤ 
> 
> `ctrl +o`  :  Override/implement Method ê³ ë¥´ê¸°
> 
> `ctrl + alt + shift + t`   -> `Extract Method`   :  ë©”ì†Œë“œ ë§Œë“¤ê¸° 

### StartLine ì¶œë ¥í•´ë³´ê¸°

> HTTP ë©”ì†Œë“œ, URL, ì¿¼ë¦¬ ìŠ¤íŠ¸ë§, ìŠ¤í‚¤ë§ˆ, í”„ë¡œí† ì½œë“± ì¡°íšŒ

```java
@WebServlet(name = "requestHeaderServlet", urlPatterns = "/request-header")
public class RequestHeaderServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        printStartLine(request);
    }


private void printStartLine(HttpServletRequest request) {
        System.out.println("--- REQUEST-LINE - start ---");
        System.out.println("request.getMethod() = " + request.getMethod()); //GET
        System.out.println("request.getProtocol() = " + request.getProtocol()); //HTTP/1.1
        System.out.println("request.getScheme() = " + request.getScheme()); //http
        // http://localhost:8080/request-header
        System.out.println("request.getRequestURL() = " + request.getRequestURL());
        // /request-header
        System.out.println("request.getRequestURI() = " + request.getRequestURI());
        //username=hi
        System.out.println("request.getQueryString() = " +
                request.getQueryString());
        System.out.println("request.isSecure() = " + request.isSecure()); //httpsì‚¬ìš© ìœ ë¬´
        System.out.println("--- REQUEST-LINE - end ---");
        System.out.println();
    }

}
```

<img src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-11-16-26-image.png" title="" alt="" data-align="center">

<br></br>

### í—¤ë” ì¶œë ¥í•´ë³´ê¸°

> HTTP í—¤ë”ì— ë“¤ì–´ì˜¤ëŠ” ì •ë³´ë¥¼ ëª¨ë‘ ì¡°íšŒí•´ë³¸ë‹¤.

```java
 // ìœ„ ìƒëµ
 private void printHeaders(HttpServletRequest request) {
        System.out.println("--- Headers - start ---");
        request.getHeaderNames().asIterator()
                .forEachRemaining(headerName -> System.out.println(headerName + ": " + request.getHeader(headerName)));
        System.out.println("--- Headers - end ---");
        System.out.println();
    }
```

<img src="file:///C:/Users/shin/AppData/Roaming/marktext/images/2022-07-12-11-22-07-image.png" title="" alt="" width="777">

<br></br>

### í¸ë¦¬í•œ Header ì¡°íšŒ

> í—¤ë”ì— ìˆëŠ” ì •ë³´ë¥¼ methodë¥¼ í†µí•´ ë‚´ê°€ ì›í•˜ëŠ” ê²ƒì„ ê³¨ë¼ì„œ ì¡°íšŒí•  ìˆ˜ë„ ìˆë‹¤. 

```java
// ìœ„ ìƒëµ
//Header í¸ë¦¬í•œ ì¡°íšŒ
private void printHeaderUtils(HttpServletRequest request) {
    System.out.println("--- Header í¸ì˜ ì¡°íšŒ start ---");
    System.out.println("[Host í¸ì˜ ì¡°íšŒ]");
    System.out.println("request.getServerName() = " +
            request.getServerName()); //Host í—¤ë”
    System.out.println("request.getServerPort() = " +
            request.getServerPort()); //Host í—¤ë”
    System.out.println();
    System.out.println("[Accept-Language í¸ì˜ ì¡°íšŒ]");
    request.getLocales().asIterator()
            .forEachRemaining(locale -> System.out.println("locale = " +
                    locale));
    System.out.println("request.getLocale() = " + request.getLocale());
    System.out.println();
    System.out.println("[cookie í¸ì˜ ì¡°íšŒ]");
    if (request.getCookies() != null) {
        for (Cookie cookie : request.getCookies()) {
            System.out.println(cookie.getName() + ": " + cookie.getValue());
        }
    }
    System.out.println();
    System.out.println("[Content í¸ì˜ ì¡°íšŒ]");
    System.out.println("request.getContentType() = " +
            request.getContentType());
    System.out.println("request.getContentLength() = " +
            request.getContentLength());
    System.out.println("request.getCharacterEncoding() = " +
            request.getCharacterEncoding());
    System.out.println("--- Header í¸ì˜ ì¡°íšŒ end ---");
    System.out.println();
    System.out.println();
}
```

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-11-31-51-image.png)

- ì¿ í‚¤ê°€ ì¡´ì¬í•˜ì§€ì•Šì•„ì„œ ì•ˆëœ¸

- `Content`ì˜ ê²½ìš° Bodyì•ˆì— ë°ì´í„°ê°€ ìˆì–´ì•¼í•œë‹¤.

<br></br>

### ê¸°íƒ€ì •ë³´ ì¡°íšŒ

> HTTP ë©”ì‹œì§€ì™¸ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.

```java
// ìœ„ ìƒëµ
//ê¸°íƒ€ ì •ë³´
private void printEtc(HttpServletRequest request) {
    System.out.println("--- ê¸°íƒ€ ì¡°íšŒ start ---");
    System.out.println("[Remote ì •ë³´]");
    System.out.println("request.getRemoteHost() = " +
            request.getRemoteHost()); //
    System.out.println("request.getRemoteAddr() = " +
            request.getRemoteAddr()); //
    System.out.println("request.getRemotePort() = " +
            request.getRemotePort()); //
    System.out.println();
    System.out.println("[Local ì •ë³´]");
    System.out.println("request.getLocalName() = " +
            request.getLocalName()); //
    System.out.println("request.getLocalAddr() = " +
            request.getLocalAddr()); //
    System.out.println("request.getLocalPort() = " +
            request.getLocalPort()); //
    System.out.println("--- ê¸°íƒ€ ì¡°íšŒ end ---");
    System.out.println();
}
```

<br></br>

<br></br>

# HTTP ìš”ì²­ ë°ì´í„°

## ê°œìš”

> ì‹¤ì§ˆì ì¸ `í´ë¼ì´ì–¸íŠ¸` -> `ì„œë²„`ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” HTTPìš”ì²­ ë©”ì‹œì§€ë¥¼ ì•Œì•„ë³´ì 

### 3ê°€ì§€ ë°©ë²•

- **GET - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°**

- **POST - HTML Form**
  
  - ìœ„ ë‘ë°©ì‹ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ í˜¸í™˜ì´ ëœë‹¤. 

- **HTTP message body**ì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­(**HTTP API**)
  
  - JSONíƒ€ì…Â Â 

## GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°

> ê²€ìƒ‰, í•„í„°, í˜ì´ì§•ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

- **URL**ì—ì„œ `?`ë¡œ ì‹œì‘í•˜ê³ , ì¶”ê°€ íŒŒë¼ë¯¸í„°ëŠ” `&`ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤.

- **ì„œë²„**ì—ì„œëŠ” HttpServletRequestê°€ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
  
  - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°íšŒ ë©”ì„œë“œ
    
    - `String` username = request.`getParameter("username");` ë‹¨ì¼ ì¡°íšŒ
    
    - `Enumeration<String>` parameterNames = request.`getParameterNames();`ëª¨ë‘ ì¡°íšŒ
    
    - `Map<String,String[]>` parameterMap = request.`getParameterMap();`  Map ì¡°íšŒ
    
    - `String[]` usernames = request.`getParameterValues("username");`  ë³µìˆ˜ì¡°íšŒ

### ëª¨ë‘ ì¡°íšŒ

```java
@Override
protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    System.out.println("[ì „ì²´ íŒŒë¼ë¯¸í„° ì¡°íšŒ] - start");
    request.getParameterNames().asIterator()
                    .forEachRemaining(paramName -> System.out.println("paramName = " +request.getParameter(paramName)));

    System.out.println("[ì „ì²´ íŒŒë¼ë¯¸í„° ì¡°íšŒ] - end");
    System.out.println();
}
```

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-12-59-50-image.png)

### ë‹¨ì¼ì¡°íšŒ

```java
//ìƒëµ
System.out.println("[ë‹¨ì¼ íŒŒë¼ë¯¸í„° ì¡°íšŒ]");
String username = request.getParameter("username");
System.out.println("request.getParameter(username) = " + username);

String age = request.getParameter("age");
System.out.println("request.getParameter(age) = " + age);
System.out.println();
```

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-13-41-24-image.png)

### ì´ë¦„ì´ ê°™ì€ ë³µìˆ˜ íŒŒë¼ë¯¸í„° ì¡°íšŒ

> [localhost:8080/request-param?username=hello&username=kim&age=20](http://localhost:8080/request-param?username=hello&username=kim&age=20)
> 
> usernameì„ 2ê°œ ë„£ì–´ì¤Œ.

```java
//ìƒëµ
System.out.println("[ì´ë¦„ì´ ê°™ì€ ë³µìˆ˜ íŒŒë¼ë¯¸í„° ì¡°íšŒ]");
String[] usernames =request.getParameterValues("username");
for(String name : usernames){
    System.out.println("username = " + name);
}
```

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-13-41-11-image.png)

### Map ì¡°íšŒ

```java
//ìƒëµ
System.out.println("[Map íŒŒë¼ë¯¸í„° ì¡°íšŒ]");
Map<String, String[]> map = request.getParameterMap();
map.entrySet().stream().iterator().forEachRemaining(stringEntry -> System.out.println("Key ê°’ : " + stringEntry.getKey() + "  valueê°’ :" + stringEntry.getValue()));
```

- Map<>ì•ˆì— ë°ì´í„° íƒ€ì…ì€,  `key = String`, `value = String[]` ìœ¼ë¡œ ì•ˆí•˜ë©´ ì˜¤ë¥˜ê°€ ë‚œë‹¤.

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-13-41-53-image.png)

> ë§Œì¼, ì¤‘ë³µíŒŒë¼ë¯¸í„°ê°€ ìˆì„ë•Œ, ë‹¨ì¼ ì¡°íšŒ`request.getParameter()`ë¥¼ ì‚¬ìš©í•˜ë©´ ì²«ë²ˆì¨° ê°’ì„ ë°˜í™˜í•œë‹¤.

<br></br>
<br></br>

## POST- HTML Form

> íšŒì›ê°€ì…, ìƒí’ˆ ì£¼ë¬¸ ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

- content-type: `application/x-www-form-urlencoded`
  
  - bodyì˜ ë°ì´í„° í˜•ì‹ì„ ì§€ì •í•˜ëŠ” ê²ƒ
  
  - `html form`ì˜ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” í˜•

- ë©”ì‹œì§€ ë°”ë””ì— **ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° í˜•ì‹**ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•œë‹¤. `username=hello&age=20`

### ì…ë ¥ í˜ì´ì§€ ë§Œë“¤ê¸°

- `html`íŒŒì¼ ìƒì„± (ìœ„ì¹˜ : `src/main/webapp/basic/hello-form.html` )

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form action="/request-param" method="post">
    username: <input type="text" name="username" />
    age: <input type="text" name="age" />
    <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```

- ì ‘ê·¼ URL : `http://localhost:8080/basic/hello-form.html`
  
  ![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-13-56-21-image.png)

- ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°íšŒ ë©”ì„œë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤. 
  
  - `request.getParameter()`  : GET URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, POST HTML Form ë‘˜ë‹¤ ì§€ì›

<br></br>

# HTTP API

## ë‹¨ìˆœ í…ìŠ¤íŠ¸

> HTTP message bodyì— ë°ì´í„°(`í…ìŠ¤íŠ¸ë¡œ!`)ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­
> 
> content-type: `text/plain`
> 
> message body: `hello`

### í…ìŠ¤íŠ¸ ë°›ëŠ” ì„œë¸”ë¦¿

```java
@WebServlet(name = "requestBodyStringServlet" , urlPatterns = "/request-body-string")
public class RequestBodyStringServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        System.out.println("messageBody = " + messageBody);

        response.getWriter().write("ok");
    }

}
```

> ì—¬ê¸°ì„œ inputStreamì€ `byte`ì½”ë“œë¥¼ ë°˜í™˜í•œë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— ë¬¸ìë¡œ ë³´ë ¤ë©´ ì¸ì½”ë”©ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤.  

- í•˜ì§€ë§Œ, ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë°©ë²•



## JSON

> HTTP message bodyì— ë°ì´í„°(`JSON!`)ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­ 
> 
> ê°€ì¥ ë§ì´ ì“°ê³  ìˆëŠ” ë°©ë²•!
> 
> content-type: `application/json`
> message body: `{"username": "hello", "age": 20}`

- Jsonì˜ ê²½ìš° íŒŒì‹±í•  ìˆ˜ ìˆëŠ” ê°ì²´ê°€ í•„ìš”í•˜ë‹¤.



### íŒŒì‹± ë°›ëŠ” ê°ì²´

```java
@Getter
@Setter
public class HelloData {
    private String username;
    private int age;
}
```

> ì´ì œ Jsonë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” Servletë¥¼ ë§Œë“¤ì–´ ë³´ì 

### Jsonë°ì´í„°ë¥¼ ë°›ëŠ” ì„œë¸”ë¦¿

```java
@WebServlet(name = "requestBodyJsonServlet", urlPatterns = "/request-body-json")
public class RequestBodyJsonServlet extends HttpServlet {

    private ObjectMapper objectMapper = new ObjectMapper();


    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        System.out.println("messageBody = " + messageBody);

        HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);

        System.out.println("helloData.getUsername() = " + helloData.getUsername());
        System.out.println("helloData.getAge() = " + helloData.getAge());
        
    }
}
```

- `Spring Controller` ëª¨ìŠµê³¼ ë§¤ìš° ìœ ì‚¬í•´ì§.

- JSonë„ ë¬¸ìì—´ì´ê¸°ì—, ë¬¸ìì—´ ê·¸ëŒ€ë¡œ ë°›ì•„ì˜¤ë©´, íŒŒì‹±ì´ ì•ˆë˜ì–´, ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ëŠ”`Jackson`ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ `Mapper`ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•¨
  
  - ëŒ€í‘œì ì¸ **Jsonì—ì„œ ìë°” ê°ì²´ë¡œ ë³€í™˜**í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” `Jackson`,` Gson` ì´ ìˆë‹¤.Â Â Â 



<br></br>
<br></br>


# HTTP ì‘ë‹µ ë°ì´í„°

## ê°œìš”

> ì‹¤ì§ˆì ì¸ `ì„œë²„` -> `í´ë¼ì´ì–¸íŠ¸`ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” HTTPì‘ë‹µ ë©”ì‹œì§€ë¥¼ ì•Œì•„ë³´ìHttpServletResponse

### 3ê°€ì§€ ë°©ë²•

- ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì‘ë‹µ

- HTML ì‘ë‹µ

- HTTP API - MessageBody JSON ì‘ë‹µ

<br></br>

## ë‹¨ìˆœ ì‘ë‹µ

### ì‘ë‹µ ë©”ì‹œì§€ ê¸°ë³¸ ì‚¬ìš©ë²•

- HTTP ì‘ë‹µì½”ë“œ ì§€ì •

- í—¤ë” ìƒì„±

- ë°”ë”” ìƒì„±

### í¸ì˜ ê¸°ëŠ¥ ì œê³µ

- Content-Type

-  ì¿ í‚¤

-  Redirect



### ì‘ë‹µë³´ë‚´ëŠ” ì„œë¸”ë¦¿

```java
@WebServlet(name = "responseHeaderServlet", urlPatterns = "/response-header")
public class ResponseHeaderServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //[status -line]
        response.setStatus(HttpServletResponse.SC_OK);

        //[responese-header]
        response.setHeader("Content-Type", "text/plain;charset=utf-8");
        response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("my-header", "hello");

        //[message body]
        // ë‹¨ìˆœ ì‘ë‹µ ë©”ì‹œì§€
        PrintWriter writer = response.getWriter();
        writer.println("ok");

    }
}


```

- statusì™€ header ì •ë³´ë¥¼ ê¸°ì…í•´ì„œ ì‘ë‹µí•œë‹¤. 

![](C:\Users\shin\AppData\Roaming\marktext\images\2022-07-12-20-59-05-image.png)

> ì´ë ‡ê²Œ ì¼ì¼ì´ ì…ë ¥í•´ì£¼ê¸°ì—ëŠ” ë²ˆê±°ë¡­ë‹¤. 
> 
> ê·¸ë˜ì„œ ì„¸íŒ…ì´ ë˜ì–´ìˆëŠ” í¸ì˜ ë©”ì„œë“œê°€ ì¡´ì¬í•œë‹¤.



### í¸ì˜ ê¸°ëŠ¥ ë©”ì„œë“œ

>    Content, ì¿ í‚¤, ë¦¬ë‹¤ì´ë ‰íŠ¸
> 
> ê¸°ì¡´ ë©”ì„œë“œëŠ” `setHeader()`ë©”ì†Œë“œì—ì„œ, í•´ë‹¹í•˜ëŠ” ì •ë³´ë³€ìˆ˜ëª…ê³¼  ë°”ê¾¸ê³ ìí•˜ëŠ” ì •ë³´ë¥¼ ê°™ì´ ì…ë ¥í•´ì¤˜ì•¼ í–ˆë‹¤. 

#### 

#### Content

```java
private void content(HttpServletResponse response) {
    //Content-Type: text/plain;charset=utf-8
    //Content-Length: 2
    //response.setHeader("Content-Type", "text/plain;charset=utf-8");
    response.setContentType("text/plain");
    response.setCharacterEncoding("utf-8");
    //response.setContentLength(2); //(ìƒëµì‹œ ìë™ ìƒì„±)
}
```

#### Cookie

```java
private void cookie(HttpServletResponse response) {
    //Set-Cookie: myCookie=good; Max-Age=600;
    //response.setHeader("Set-Cookie", "myCookie=good; Max-Age=600");
    Cookie cookie = new Cookie("myCookie", "good");
    cookie.setMaxAge(600); //600ì´ˆ
    response.addCookie(cookie);
}
```

#### Redirect

```java
private void redirect(HttpServletResponse response) throws IOException {
    //Status Code 302
    //Location: /basic/hello-form.html
    //response.setStatus(HttpServletResponse.SC_FOUND); //302
    //response.setHeader("Location", "/basic/hello-form.html");
    response.sendRedirect("/basic/hello-form.html");
}
```

<br></br>


## HTML ì‘ë‹µ
> ì‘ë‹µì„ `HTML`ë¡œ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.  
> HTTPì‘ë‹µìœ¼ë¡œ content-typeì„ `text/html`ë¡œ ì§€ì •í•´ì•¼í•œë‹¤. 

```java
// ìœ„ ìƒëµ
@Override
protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    //Content-Type: text/html;charset=utf-8
    response.setContentType("text/html");
    response.setCharacterEncoding("utf-8");
    PrintWriter writer = response.getWriter();
    writer.println("<html>");
    writer.println("<body>");
    writer.println(" <div>ì•ˆë…•?</div>");
    writer.println("</body>");
    writer.println("</html>");
}
```


<br></br>
## API JSON ì‘ë‹µ
> HTTP API
> HTTP ì‘ë‹µìœ¼ë¡œ JSONì„ ë°˜í™˜í•  ë•ŒëŠ” content-typeì„ `application/json` ë¡œ ì§€ì •í•´ì•¼ í•œë‹¤.
> Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” `objectMapper.writeValueAsString()` ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ì²´ -> JSONìœ¼ë¡œ ë³€ê²½
 - ê¸°ë³¸ì ìœ¼ë¡œ `application/json`ì€ utf-8í˜•ì‹ì„ ì‚¬ìš©í•˜ë„ë¡ ì •ì˜ë˜ì–´ ìˆë‹¤.

```java
// ìœ„ ìƒëµ
private ObjectMapper objectMapper = new ObjectMapper();

@Override
protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //Content-Type: application/json
        response.setHeader("content-type", "application/json");
        response.setCharacterEncoding("utf-8");
        HelloData data = new HelloData();
        data.setUsername("kim");
        data.setAge(20);
        //{"username":"kim","age":20}
        String result = objectMapper.writeValueAsString(data);
        response.getWriter().write(result);
}
```

<img src="https://user-images.githubusercontent.com/104331549/178492232-603c3962-c367-42bb-afde-b1317078e03b.png">



## ëŠë‚€ì  ğŸ˜Œ
 - Servletì— ëŒ€í•œ ê°œë…ì´ í™•ì‹¤íˆ ì¡íˆê³ , 
 - Controllerê°€ ìƒê¸°ê¸°ì „ ëª¨ìŠµì„ ë°°ìš°ë©´ì„œ ì™œ í•„ìš”í•œì§€ ì•Œê²Œë˜ì—ˆë‹¤.
### ì°¸ê³  ë§í¬
